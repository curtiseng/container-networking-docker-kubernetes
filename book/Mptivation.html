<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>第一章 本书的写作动机 - Container Networking Dokcer Kubernetes</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="Preface.html">序言</a></li><li><a href="Mptivation.html" class="active"><strong aria-hidden="true">1.</strong> 第一章 本书的写作动机</a></li><li><a href="Introduction_to_Container_Networking.html"><strong aria-hidden="true">2.</strong> 第二章 介绍容器网络</a></li><li><a href="Multi-Host_Networking.html"><strong aria-hidden="true">3.</strong> 第三章 介绍多主机的网络</a></li><li><a href="TBD.html"><strong aria-hidden="true">4.</strong> 第四章 编排</a></li><li><a href="TBD.html"><strong aria-hidden="true">5.</strong> 第五章 服务发现</a></li><li><a href="TBD.html"><strong aria-hidden="true">6.</strong> 第六章 容器网络接口</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.</strong> 第七章 Kubernetes 网络</a></li><li><ol class="section"><li><a href="TBD.html"><strong aria-hidden="true">7.1.</strong> Kubernetes 简介</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.2.</strong> Kubernetes 网络简介</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.3.</strong> Pod 内部网络通信</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.4.</strong> Pod 间网络通信</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.5.</strong> Kubernetes 中的服务发现</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.6.</strong> Ingress 和 Egress</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.7.</strong> Kubernetes 网络的高级主题</a></li><li><a href="TBD.html"><strong aria-hidden="true">7.8.</strong> 本章小结</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Container Networking Dokcer Kubernetes</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#第一章-动机" id="第一章-动机"><h3>第一章 动机</h3></a>
<hr />
<p>在这一章节，我将向您介绍<em>宠物模式</em>下和<em>牲畜模式</em>下计算基础设施以及容器网络所涉及的内容。如果你对基础设施和网络比较熟悉，可以跳过这一章节。</p>
<a class="header" href="#介绍-宠物模式-和-牲畜模式" id="介绍-宠物模式-和-牲畜模式"><h4>介绍 <em>宠物模式</em> 和 <em>牲畜模式</em></h4></a>
<p>在2012年二月，Randy Bias关于开放和可扩展云架构主题做了一个有效的演讲。在他的陈述中，他提出了<em>pets versus cattle</em>模式。</p>
<ul>
<li>用<em>宠物模式</em>来管理基础设施，你把机器当成个体。给每个(虚拟)机器一个名称，应用程序被静态地分配给机器。例如，<code>db-prod-2</code>是生产环境服务的数据库所在的机器。应用程序是手动部署的，当机器生病时，你必须让他恢复健康，并手动重新部署你的应用程序到另一台机器上。这种方法通常被认为是以前(非云原生)时代的主导范例。</li>
<li>用<em>牲畜模式</em>来管理基础设施，你的机器是非特定的；它们都是相同的(模块化硬件升级)，它们有数字而不是名字，应用程序被自动部署到任何一台机器上。当其中一台机器生病时，你不会马上担心他;你可以在你想要的时候替换它，或者部分替换它，比如一个有问题的硬盘驱动器，而不是当东西坏掉的时候。</li>
</ul>
<p>最初这种模式关注的是虚拟机，而我们将牛群方法应用于基础设施。</p>
<a class="header" href="#牲畜模式" id="牲畜模式"><h4><em>牲畜模式</em>！</h4></a>
<p>使用管理牲畜的方法来管理基础设施的好处是，他容许你水平扩展硬件的规模。</p>
<p><em>牲畜模式</em>提供了混合云概念中的弹性。一个特定的例子是你可将应用的部分部署在私有机器上，在你需要扩展的时候，直接可以使用公有云。</p>
<p>最重要的是,从运维者的角度来看,<em>牲畜模式</em>允许你安心的睡觉,你不必担心在凌晨3点更换坏掉的硬盘驱动器或重新挂应用到不同的服务器上。</p>
<p>然而，<em>牲畜模式</em>也带来了一些挑战，一般可以归纳为以下两个方面：</p>
<p><strong>推广挑战：</strong></p>
<p>我敢说，大多数挑战都具有社会性:我如何说服我的经理?我如何从我的首席技术官那里得到股份?我的同事们会反对这种新的做事方式吗?这是否意味着我们需要更少的人来管理我们的基础设施?</p>
<p><strong>技术挑战：</strong></p>
<p>这类问题包括处理诸如机器的基本运维问题。例如，使用Ansible安装Kubernetes组件，如何在容器和外部世界之间建立通信连接，最重要的是，如何确保容器被自动部署和被发现。</p>
<p>现在你已经了解了<em>pets versus cattle</em>，接下来对容器网络的整体技术栈做一个认识。</p>
<a class="header" href="#容器网络技术栈" id="容器网络技术栈"><h4>容器网络技术栈</h4></a>
<p>我们介绍的堆栈包含以下内容：</p>
<p><strong><em>The low-level networking layer</em></strong></p>
<p>这包括网络设备、iptables、路由、IPVLAN和Linux名称空间。除非你在网络团队中， 你通常不需要知道这个层的细节，但是你至少应该知道它。这些技术已经存在并使用了10年以上。</p>
<p><strong><em>The container networking layer</em></strong></p>
<p>这一层提供了一些底层的抽象，比如单主机模式和多主机模式网桥、IP-per-container解决方案。在第二章和第三章中介绍了这一层。</p>
<p><strong><em>The container orchestration layer</em></strong></p>
<p>这里，我们将把容器调度器关于在何处放置容器的决定与底层提供的原语结合起来。在第4章中，我们将讨论总体的容器编排系统，在第5章中，我们将重点讨论服务发现方面，包括负载平衡。第6章讨论了容器网络标准CNI，最后在第7章我们讨论了Kubernetes网络。</p>
<blockquote>
<p>SDN(<em>Software-Defined Networking</em>)实际上是一个概括(营销)术语，它提供了与虚拟机(VMs)通过裸金属服务器引入的网络相同的优势。通过这种方法，网络管理团队变得更加敏捷，能够更快地对不断变化的业务需求做出反应。另一种看法是:SDN是使用软件的网络配置，无论是通过api，补充网络功能虚拟化，还是通过软件构建网络。
特别是如果您是开发人员或架构师，我建议您快速浏览一下Cisco关于这个主题的<a href="http://bit.ly/1O5p7KB">优秀概述</a>，以及SDxCentral的文章“<a href="https://bit.ly/2jvUkiO">什么是软件定义的网络(SDN)</a>?”</p>
</blockquote>
<p>如果你是网络运维团队的一员，你应该可以很好进入下一章。如果你是一名架构师或开发人员，你的网络知识可能有点生疏，建议在继续之前先温习一下<a href="http://www.tldp.org/LDP/nag2/nag2.pdf">Linux网络管理员指南</a>。</p>
<a class="header" href="#我需要all-in吗" id="我需要all-in吗"><h4>我需要“All In”吗？</h4></a>
<p>通常，当我参加研讨会或者用户组时，我遇到许多人对容器领域的机会十分兴奋。同时，人们本能的也担心需要多大程度的投入才能从中受益。下表提供了我搜集的部署规模的非正式概述，按照各个阶段所表达的级别进行分组:</p>
<table><thead><tr><th> 阶段        </th><th> 典型的设施                                   </th><th> 例子                         </th></tr></thead><tbody>
<tr><td> Traditional </td><td> 裸机或者VM，没有容器                         </td><td> 现在大部分的生产部署         </td></tr>
<tr><td> Simple      </td><td> 手动管理应用依赖，手动运行容器               </td><td> 开发和测试环境               </td></tr>
<tr><td> Ad hoc      </td><td> 自定义、自定义调度器，用于启动和重新启动容器 </td><td> RelateIQ, Uber               </td></tr>
<tr><td> Full-blown  </td><td> 调度程序来管理容器;容错,自愈                 </td><td> Google, Zulily, Gutefrage.de </td></tr>
</tbody></table>
<p>请注意，阶段不一定与部署的规模相一致。例如，Gutefrage.de只有6台需要管理的物理服务器，但是使用Apache Mesos来管理它们，并且您可以在树莓Pi上轻松地运行Kubernetes集群。</p>
<p>在我们继续之前还有最后一点:到目前为止，您可能已经意识到我们在这里讨论的是分布式系统。鉴于我们通常希望将容器部署到计算机网络中，我建议您阅读一下<a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing">分布式计算的谬误</a>，以防您还不熟悉这个主题。</p>
<p>现在让我们继续讨论容器网络的深层问题。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="Preface.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="Introduction_to_Container_Networking.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="Preface.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="Introduction_to_Container_Networking.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
